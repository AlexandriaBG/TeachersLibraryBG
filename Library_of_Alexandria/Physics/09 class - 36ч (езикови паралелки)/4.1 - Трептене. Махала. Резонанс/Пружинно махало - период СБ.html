<!DOCTYPE html>
<html lang="bg">
<head>
<meta charset="UTF-8">
<title>Пролетен махало / Spring Pendulum</title>
<style>
  body { margin:0; font-family:sans-serif; display:flex; height:100vh; }
  #controls { width:40%; padding:40px; background:#f0f0f0; box-sizing:border-box; font-size:24px; }
  #controls label { display:block; margin:20px 0 10px; }
  #controls input { width:100%; padding:5px; font-size:24px; }
  #visual { width:60%; background:#eef; display:flex; justify-content:center; align-items:center; position: relative; }
  #canvas { border:1px solid #333; width:90%; height:90%; }
  #formula { margin-top:20px; font-size:28px; }
</style>
</head>
<body>

<div id="controls">
  <h2>Пролетен махало</h2>
  <div id="periodDisplay">Период T = 2π√(m/k) = 1.99 s</div>
  
  <label>Маса (кг):
    <input type="number" id="mass" value="1" min="0.1" max="10" step="0.1">
  </label>
  
  <label>Дължина на пружината (m):
    <input type="number" id="length" value="1" min="0.1" max="5" step="0.05">
  </label>
  
  <label>Амплитуда (m):
    <input type="number" id="amplitude" value="0.4" min="0.05" max="1" step="0.05">
  </label>

  <label>Константа на пружината k (N/m):
    <input type="number" id="springK" value="10" min="0.1" max="100" step="0.1">
  </label>
  
  <div id="formula">T = 2π √(m/k)</div>
</div>

<div id="visual">
  <canvas id="canvas" width="600" height="600"></canvas>
</div>

<script>
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');

let mass = parseFloat(document.getElementById('mass').value);
let length = parseFloat(document.getElementById('length').value);
let amplitude = parseFloat(document.getElementById('amplitude').value);
let k = parseFloat(document.getElementById('springK').value);

let omega = Math.sqrt(k/mass);
const cy0 = 100; // top of spring
const springSticks = 15;
const massRadius = 20;
let t = 0;
const dt = 0.02;

const periodDisplay = document.getElementById('periodDisplay');

function updatePeriodDisplay(){
    const T = 2*Math.PI*Math.sqrt(mass/k);
    periodDisplay.innerText = `Период T = 2π√(m/k) = ${T.toFixed(2)} s`;
}

function draw() {
    ctx.clearRect(0,0,canvas.width,canvas.height);

    let x = amplitude * Math.cos(omega * t);
    let yMass = cy0 + length*100 + x*100;
    const yMin = cy0 + massRadius;
    const yMax = canvas.height - massRadius;
    yMass = Math.min(yMax, Math.max(yMin, yMass));

    ctx.strokeStyle = "#333";
    ctx.lineWidth = 3;
    ctx.beginPath();
    ctx.moveTo(canvas.width/2, cy0);
    for(let i=0; i<springSticks; i++){
        let yi = cy0 + i*(yMass-cy0)/springSticks;
        let xi = canvas.width/2 + (i%2==0?10:-10);
        ctx.lineTo(xi, yi);
    }
    ctx.lineTo(canvas.width/2, yMass);
    ctx.stroke();

    ctx.fillStyle = "orange";
    ctx.beginPath();
    ctx.arc(canvas.width/2, yMass, massRadius, 0, Math.PI*2);
    ctx.fill();
}

function animate(){
    t += dt;
    draw();
    requestAnimationFrame(animate);
}

function updateParams(){
    mass = Math.min(Math.max(parseFloat(document.getElementById('mass').value),0.1),10);
    length = Math.min(Math.max(parseFloat(document.getElementById('length').value),0.1),5);
    amplitude = Math.min(Math.max(parseFloat(document.getElementById('amplitude').value),0.05),1);
    k = Math.min(Math.max(parseFloat(document.getElementById('springK').value),0.1),100);

    document.getElementById('mass').value = mass;
    document.getElementById('length').value = length;
    document.getElementById('amplitude').value = amplitude;
    document.getElementById('springK').value = k;

    omega = Math.sqrt(k/mass);
    updatePeriodDisplay();
}

document.getElementById('mass').addEventListener('input', updateParams);
document.getElementById('length').addEventListener('input', updateParams);
document.getElementById('amplitude').addEventListener('input', updateParams);
document.getElementById('springK').addEventListener('input', updateParams);

updatePeriodDisplay();
animate();
</script>

</body>
</html>
